# ---------- Stage 1: Build ----------
FROM openjdk:17-jdk-alpine AS builder

# Set working directory
WORKDIR /app

# Copy source files into container
COPY src/Main.java /app/
COPY quotes.txt /app/

# Compile Java source
RUN javac Main.java

# ---------- Stage 2: Runtime ----------
FROM openjdk:17-jdk-alpine

# Set working directory
WORKDIR /app

# Copy only the compiled class and required files from builder stage
COPY --from=builder /app/Main.class /app/
COPY --from=builder /app/quotes.txt /app/

# Expose the application port
EXPOSE 8000

# Run the app
CMD ["java", "Main"]
